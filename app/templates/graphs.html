<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Graphs</title>
    <link rel="stylesheet" href="static/css/graphs.css">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

</head>
<body class="main">
    <div class="bg-blue-900">
        <div class="mx-auto max-w-7xl px-2 sm:px-6 lg:px-8">
            <div class="relative flex h-16 items-center justify-between">
                <div class="absolute inset-y-0 left-0 flex items-center sm:hidden">
                </div>
                <div class="flex flex-1 items-center justify-center sm:items-stretch sm:justify-start">
                    <div class="hidden sm:ml-6 sm:block">
                        <div class="flex space-x-4">
                            <a href="/" class="rounded-md px-3 py-2 text-sm font-medium text-gray-50 hover:bg-red-700 hover:text-white">Home</a>
                            <a href="/graphs" class="rounded-md px-3 py-2 text-sm font-medium text-gray-50 hover:bg-red-700 hover:text-white">Graphs</a>
                            <a href="/discussion" class="rounded-md px-3 py-2 text-sm font-medium text-gray-50 hover:bg-red-700 hover:text-white">Discussion</a>
                            {% if username %}
                            <div class="rounded-md px-3 py-2 text-sm font-medium text-gray-50 hover:bg-red-700 hover:text-white">
                                <a href="{{ url_for('logout') }}">Log out</a><br>
                            {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="bg-gray-200 rounded-2xl text-center m-4">
        <h1 class="text-3xl font-semibold">CPI vs Positive Presidential Approval Ratings</h1>
        <div id="chart1"></div>
    </div>
    <div class="bg-gray-200 rounded-2xl text-center m-4">
        <h1 class="text-3xl font-semibold">CPI vs Negative Presidential Approval Ratings</h1>
        <div id="chart2"></div>
    </div>

    <script>

        const dates = {{ dates | tojson }};
        const cpi_values = {{ cpi_values }};
        const approval_values = {{ approval_values }};
        const negative_approval_values = approval_values.map(val => 100 - val);

        const options1 = {
            chart: {
                type: 'line',
                height: 500,
                zoom: { enabled: true }
            },
            series: [
                {
                    name: 'CPI',
                    type: 'line',
                    data: cpi_values
                },
                {
                    name: 'Positive Approval Ratings (%)',
                    type: 'line',
                    data: approval_values
                }
            ],
            xaxis: {
                categories: dates,
                title: { text: 'Date' }
            },
            yaxis: [
                {
                    title: { text: 'CPI' },
                },
                {
                    title: { text: 'Positive Approval Ratings (%)' },
                    labels: { formatter: (val) => val + "%" },
                    opposite: true
                }
            ]
        };

        const options2 = {
            chart: {
                type: 'line',
                height: 500,
                zoom: { enabled: true }
            },
            series: [
                {
                    name: 'CPI',
                    type: 'line',
                    data: cpi_values
                },
                {
                    name: 'Negative Approval Ratings (%)',
                    type: 'line',
                    data: negative_approval_values
                }
            ],
            xaxis: {
                categories: dates,
                title: { text: 'Date' }
            },
            yaxis: [
                {
                    title: { text: 'CPI' },
                },
                {
                    title: { text: 'Negative Approval Ratings (%)' },
                    labels: { formatter: (val) => val + "%" },
                    opposite: true
                }
            ]
        };

        const chart1 = new ApexCharts(document.querySelector("#chart1"), options1);
        const chart2 = new ApexCharts(document.querySelector("#chart2"), options2);

        chart1.render();
        chart2.render();

    </script>

</body>
</html>